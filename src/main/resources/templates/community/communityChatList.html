<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{/fragments/layout}">
<head>
    <!--  tagify  -->
    <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
    <link href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css" rel="stylesheet" type="text/css"/>

    <title>잡담 - 제주도랑 | 커뮤니티</title>
</head>

<th layout:fragment="content">

    <div class="board-whole-box">
        <div class="board-item board-tab">
            <ul class="nav flex-column">
                <li class="nav-item" style="font-size: 20px;">
                    <a class="nav-link" href="#" style="color: #696969;"
                       th:href="@{/community/parties}">모임</a>
                </li>
                <li class="nav-item" style="font-size: 20px;">
                    <a class="nav-link active" aria-current="page"  href="#" style="color: #696969;"
                       th:href="@{/community/chats}">잡담</a>
                </li>
            </ul>
        </div>

        <div class="board-item board-main">
            <form class="search-input-box" th:method="get" th:action>
                <div class="search-input-box-sub">
                    <input class="search-words" name="search" th:placeholder="${currentSearchWord}" th:value="${currentSearchWord}">
                    <button type="submit" class="btn btn-success search-btn" style="background: #FB7A51; border: none">검색</button>
                </div>
                <div class="search-input-tag-box-sub">
                    <input type="text" class="search-tags" id="search-form-tags" name="tags" placeholder="태그로 검색해보세요"
                    th:value="${currentSearchTag}">
<!--                    <button type="button" class="btn btn-light reset-btn">초기화</button>-->
                </div>
            </form>

            <div class="sort-and-write-box">
                <ul class="nav">

                    <!-- 검색어 있는 경우, 없을 경우 분리 -->
                    <li class="nav-item">
                        <a th:if="${currentSearchWord} != null"
                            class="nav-link active" aria-current="page" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(search=${currentSearchWord}, tags=${currentSearchTag})}">최신순</a>
                        <a th:if="${currentSearchWord} == null"
                            class="nav-link active" aria-current="page" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(tags=${currentSearchTag})}">최신순</a>
                    </li>
                    <li class="nav-item">
                        <a th:if="${currentSearchWord} != null"
                            class="nav-link" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(search=${currentSearchWord}, order='comment', tags=${currentSearchTag})}">댓글많은순</a>
                        <a th:if="${currentSearchWord} == null"
                            class="nav-link" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(order='comment', tags=${currentSearchTag})}">댓글많은순</a>
                    </li>
                    <li class="nav-item">
                        <a th:if="${currentSearchWord} != null"
                           class="nav-link" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(search=${currentSearchWord}, order='bookmark', tags=${currentSearchTag})}">북마크순</a>
                        <a th:if="${currentSearchWord} == null"
                           class="nav-link" href="#" style="font-size: 18px; color: #696969"
                           th:href="@{/community/chats(order='bookmark', tags=${currentSearchTag})}">북마크순</a>
                    </li>

                </ul>

                <a class="btn btn-primary write-btn"
                   th:href="@{/community/post/new(type=chat)}"
                   href="#" role="button" style="background: #696969">글쓰기</a>
            </div>

            <div class="board-cards-box">

                <div th:each="post : ${chatListDtoPage}" class="card w-75 mb-3" style="min-width:100%; max-height:170px;">
                    <div class="card-body" style="width:100%;" th:onclick="|location.href='@{/community/chats/{communityId}(communityId=${post.id})}'|">
                        <h5 class="card-title" style="font-weight: bold;" th:text="${post.title}">Card title</h5>

                        <div class="card-tags">
                            <ul class="sub-body-tags">
                                <li class="sub-body-tag" th:each="tag : ${post.tags}" th:text="${tag}">태그1</li>
                            </ul>
                        </div>

                        <div class="card-bottom">
                            <div class="card-text card-bottom-sub">
                                <small th:text="${post.nickname}">nickname</small>
                                <small> • </small>
                                <small th:text="${post.createdAt}">date</small>
                            </div>
                            <div class="card-text card-bottom-sub">
                                <small>추천 <span th:text="${post.bookmarkCount}">0</span></small>
                                <small>조회 <span th:text="${post.viewCount}">0</span></small>
                                <small>댓글 0</small>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

            <!-- 페이지 네비게이션 블록 -->
            <div class="board-paging">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">

                        <li class="page-item">
                            <a class="page-link" th:href="@{/community/chats(page='0', order=${order}, search=${currentSearchWord}, tags=${currentSearchTag})}" href="#" aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>

                        <li class="page-item" th:if="${nowPage > 0}"><a class="page-link" th:href="@{/community/chats(page=${nowPage}-1, order=${order}, search=${currentSearchWord}, tags=${currentSearchTag})}" href="#" th:text="${nowPage - 1}">0</a></li>
                        <li class="page-item"><a class="page-link" th:href="@{/community/chats(page=${nowPage}, order=${order}, search=${currentSearchWord}, tags=${currentSearchTag})}" href="#" th:text="${nowPage}">2</a>
                        <li class="page-item" th:if="${nowPage < allChatPageCount - 1}"><a class="page-link" th:href="@{/community/chats(page=${nowPage}+1, order=${order}, search=${currentSearchWord}, tags=${currentSearchTag})}" href="#" th:text="${nowPage + 1}">3</a></li>

                        <li class="page-item">
                            <a class="page-link" th:href="@{/community/chats(page=${allChatPageCount}-1, order=${order}, search=${currentSearchWord}, tags=${currentSearchTag})}" href="#" aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>

                    </ul>
                </nav>
            </div>

        </div>
    </div>

    <!-- tagify -->
    <script>
        var input = document.querySelector('#search-form-tags')
        var tagify = new Tagify(input, {
            dropdown: { // dropdown 속성 -> 드롭다운 비활성화
                enabled: 0
            },
            originalInputValueFormat: valuesArr => valuesArr.map(item => item.value).join(','),
            texts: {
                duplicate: "Duplicates are not allowed"
            },
        })
    </script>

</th>


</html>